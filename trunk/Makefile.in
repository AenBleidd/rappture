
bindir          = @bindir@
datadir		= @datadir@
datarootdir	= @datarootdir@
exec_prefix     = @exec_prefix@
includedir      = @includedir@
libdir          = @libdir@
mandir          = @mandir@
prefix          = @prefix@
srcdir		= @srcdir@

INSTALL		= @INSTALL@
SHELL		= @SHELL@
RM		= rm -f
VPATH		= $(srcdir)

build_date	:= $(shell date +%Y%m%d)
machine		:= $(shell uname -m | sed 's/\ //')
os		:= $(shell uname -s)
bn		:= $(shell basename $(prefix))

tarfile		= rappture-$(os)-$(machine)-$(build_date).tar.gz

ENABLE_GUI = @ENABLE_GUI@

ifneq ($(ENABLE_GUI),)
   GUI = gui
endif

.PHONY: src gui lang test examples

all: src gui lang examples test lib

src:
	$(MAKE) -C src all
gui:
	$(MAKE) -C gui all
lang:
	$(MAKE) -C lang all
lib:
	$(MAKE) -C lib all
examples:
	$(MAKE) -C examples all
test:
	#$(MAKE) -C test all

install: 
	$(MAKE) -C examples install
	$(MAKE) -C gui install
	$(MAKE) -C lang install
	$(MAKE) -C lib install
	$(MAKE) -C src install

clean:
	$(MAKE) -C examples clean
	$(MAKE) -C gui clean
	$(MAKE) -C lang clean
	$(MAKE) -C lib clean
	$(MAKE) -C src clean
	$(MAKE) -C test clean

distclean: 
	$(MAKE) -C examples distclean
	$(MAKE) -C gui distclean
	$(MAKE) -C lang distclean
	$(MAKE) -C lib distclean
	$(MAKE) -C src distclean
	$(MAKE) -C test distclean
	$(RM) Makefile config.status config.log  *~

package: 
	tar -C $(prefix) -czlf $(tarfile) .
