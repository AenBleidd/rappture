#! /bin/sh

DISPLAY=:0
export DISPLAY

install_dir=@prefix@
nanoscalePort=2000
nanovisPort=2000
pymolPort=2020

dir=$( mktemp -d /tmp/nanorun.XXXXXX )

PATH=${dir}/bin:$PATH
LD_LIBRARY_PATH=${dir}/lib:$LD_LIBRARY_PATH
PYMOL_PATH=${dir}/lib/pymol
export PATH LD_LIBRARY_PATH PYMOL_PATH

cp -r ${install_dir}/* ${dir}

cd ${dir}

minutes=20
ulimit -t $(expr ${minutes} \* 60 )

#${dir}/bin/nanoscale -d -b ${nanoscalePort} -s 192.168.200.255 -l ${nanovisPort} -c "${dir}/bin/nanovis -p ${dir}/lib/shaders:${dir}/lib/resources"
#${dir}/bin/nanoscale -d -b ${nanoscalePort} -s 192.168.200.255 -l ${pymolPort} -c "${dir}/bin/pymolproxy ${dir}/bin/pymol -p -q -i -x -X 0 -Y 0"
${dir}/bin/nanoscale -b ${nanoscalePort} -s 192.168.200.255 -l ${nanovisPort} -c "${dir}/bin/nanovis -p ${dir}/lib/shaders:${dir}/lib/resources" -l ${pymolPort} -c "${dir}/bin/pymolproxy ${dir}/bin/pymol -p -q -i -x -X 0 -Y 0"
